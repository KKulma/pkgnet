#' @title Age One
#' @name One
#' @family TheEnd
#' @description Age One
#' @importFrom R6 R6Class
#' @export
One <- R6::R6Class(
    "One",
    public = list(
        initialize = function() {
            cat("The End, by A. A. Milne")
        },
        print_poem = function() {
            cat("When I was One, \n", 
                "I had just begun. \n"
                )
        },
        how_old_am_i = function() {private$get_age()}
    ),
    private = list(
        get_age = function() {.classname(self)}
    )
)

#' @title Age Two
#' @name Two
#' @family TheEnd
#' @description Age Two
#' @importFrom R6 R6Class
#' @export
Two <- R6::R6Class(
    "Two",
    inherit = One,
    public = list(
        print_poem = function() {
            super$print_poem()
            cat("When I was Two, \n", 
                "I was nearly new. \n"
            )
        }
    )
)

#' @title Age Three
#' @name Three
#' @family TheEnd
#' @description Age Three
#' @importFrom R6 R6Class
#' @export
Three <- R6::R6Class(
    "Three",
    inherit = Two,
    public = list(
        print_poem = function() {
            super$print_poem()
            cat("When I was Three, \n", 
                "I was hardly me. \n"
            )
        }
    )
)

#' @title Age Four
#' @name Four
#' @family TheEnd
#' @description Age Four
#' @importFrom R6 R6Class
#' @export
Four <- R6::R6Class(
    "Four",
    inherit = Three,
    public = list(
        print_poem = function() {
            super$print_poem()
            cat("When I was Four, \n", 
                "I was not much more. \n"
            )
        }
    )
)

#' @title Age Five
#' @name Five
#' @family TheEnd
#' @description Age Five
#' @importFrom R6 R6Class
#' @export
Five <- R6::R6Class(
    "Five",
    inherit = Four,
    public = list(
        print_poem = function() {
            super$print_poem()
            cat("When I was Five, \n", 
                "I was just alive. \n"
            )
        }
    ),
    private = list(
    )
)

#' @title Age Six
#' @name Six
#' @family TheEnd
#' @description Age Six
#' @importFrom R6 R6Class
#' @export
Six <- R6::R6Class(
    "Six",
    inherit = Five,
    public = list(
        print_poem = function() {
            super$print_poem()
            cat("When I was Six, \n", 
                "I'm as clever as clever. \n"
            )
            private$print_ending()
        }
    ),
    private = list(
        print_ending = function() {
            cat("So I think I'll be Six now, \n",
                "Forever and ever."
            )
        }
    )
)

# [description] internal function
.classname <- function(obj) {
    class(obj)[1]
}


